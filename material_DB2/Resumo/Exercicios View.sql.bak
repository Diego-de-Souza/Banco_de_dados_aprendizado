bn  b nnmvbnbbbnm /*
Exercicios sobre VIEWS
Utilizando o banco de dados de Veiculos, faça
1) Crie uma view que retorne todos os dados dos
clientes, juntamente com a descricao de seu estado 
civil. Salve esta view com o nome de VW_EX_1

2) Crie uma view que utilize a VW_EX_1 e acrescente
nela descricao de seu UF. Salve esta view com o nome 
de VW_EX_2

3) Crie uma consulta que exiba, o nome do cliente,
a descricao de seu estado civil, e o nome de todos
os veículos que ela possui. Utilize as Views anteriores

4) Crie uma view que traga todos os dados das tabelas
alienanção, cores e marcas. Salve esta view com o nome 
de VW_EX_4
*/

--1)
alter view VW_EX_1 as
	select c.*, ec.desc_estado_civil
	from tb_clientes c
	inner join tb_estado_civil ec on c.cod_estado_civil = ec.cod_estado_civil

select * from VW_EX_1

--2)
alter view VW_EX_2 as
	select vw.*, e.desc_uf
	from VW_EX_1 vw
	inner join tb_estados e on e.cod_uf = vw.cod_uf
	
select * from VW_EX_2

--3)
select vw.nome, vw.desc_estado_civil, a.modelo
from tb_alienacao a
right join vw_ex_1 vw on a.cod_cliente = vw.cod_cliente

--4)
alter view VW_EX_4 as 
	select a.*, c.desc_cor, m.desc_marca
	from tb_alienacao a
	inner join tb_cores c on c.cod_cor = a.cod_cor
	inner join tb_marcas m on m.cod_marca= a.cod_marca

select * from VW_EX_4